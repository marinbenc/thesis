\chapter{Sažetak}

Segmentacija medicinske slike igra ključnu ulogu u raznim medicinskim primjenama od kirurškog planiranja preko dijagnostike do istraživanja. Taj se proces često oslanja na neuronske mreže za točnu segmentaciju raznih modaliteta slike kao što su CT, MRI, mikroskopija, dermatoskopija i druge. Međutim, uspješnost ovih modela je značajno uvjetovano dostupnosti i kvalitetom podataka za trening, koje je često teško prikupiti zbog visokih vremenskih i financijskih zahtjeva dobivanja slika, invazivnosti nekih procedura medicinskog slikanja, velikih datoteka i regulatornih zahtjeva vezanih uz medicinske slike.

Količina truda i stručnosti koju zahtjeva označavanje medicinskih slika  dodatno pogoršava navedene izazove, što čini prikupljanje velikih visokokvalitetnih skupova podataka za treniranje neuronskih mreža posebnom zahtjevnim. Zbog ovog nedostatka podataka potrebno je razviti podatkovno učinkovite modele segmentacije koji mogu dati pouzdane rezultate s ograničenim brojem uzoraka.

Iz područja statistike i teorije statističkog učenja, postavljena je teorija da, kako zadaci segmentacije medicinskih slika postaju kompleksniji, oni zahtijevaju neuronske mreže sa sve više parametara za uspješnu segmentaciju. Taj zahtjev za povećanjem parametara tada zahtjeva više uzoraka kako bi se izbjegla prenaučenost modela. Međutim, u medicinskim slikama nema dovoljno podatkovnih skupova s velikim brojem uzoraka. U ovom doktorskom radu je predstavljen pregled metoda segmentacije medicinskih slika i postojeće strategije poboljšanja podatkovne učinkovitosti tih metoda.

Predstavljene su razne nove metode koje pojednostavljuju zadatak segmentacije, što omogućuje treniranje neuronskih mreža s manjim brojem parametara te time manje potrebnih uzoraka. Metode se zasnivaju na transformiranju segmentacijske granice u oblik koji se može modelirati manjim brojem parametara. To se postiže korištenjem znanja iz domene i tradicionalnim tehnikama obrade slike kako bi se identificirale korisne transformacije slike. Razvijene su neuronske mreže koje dinamički određuju parametre tih transformacija za svaku sliku. Time se zadatak segmentacije razlomi na dva lakša zadatka: inicijalna gruba lokalizacija ciljanog objekta koja je popraćena segmentacijom pojednostavljene reprezentacije slike.

Uspješnost predstavljenih metoda procijenjena je u raznim modalitetima medicinske slike, uključujući CT, mikroskopiju, dermatoskopiju i kolonoskopiju. Pokazana su poboljšanja ne samo u podatkovnom učinkovitosti nego su i za neke segmentacijske zadatke postignuti rezultati bolji od onih objavljenih u dosadašnjoj literaturi. Predstavljene metode su fleksibilne i koriste za širok spektar tipova medicinskih slika. Mogu se koristiti kao opći koraci pretprocesiranja slika za bilo koju arhitekturu segmentacijskih konvolucijskih neuronskih mreža.

Konkretnije, koriste se dvije neuronske mreže za učinkovito rješavanje problema segmentacije. Prva se mreža fokusira na grubo lokaliziranje ciljanog objekta koristeći kao oznake Gaussovu distribuciju centriranu na objektu ili standardne segmentacijske mape. Zatim se konstruira funkcija koja za danu grubu lokalizaciju daje parametre transformacije slike, a čija je svrha pojednostavljivanje zadatka segmentacije. Proces odlučivanja o korištenoj funkciji i transformaciji slike zasniva se na znanju iz domene i empirijski utvrđenim rezultatima. Primjerice, kako bi se učinkovitije segmentirali eliptični objekti koristi se polarna transformacija slike, i to tako da je polarno ishodište pozicionirano u središtu objekta. Ulazna slika prolazi kroz transformaciju slike prema dobivenim parametrima kao priprema za drugu neuronsku mrežu koja obavlja detaljnu segmentaciju. Ta je druga mreža posebno trenirana na transformiranim slikama koristeći parametre koji su dobiveni od ručno označenih segmentacijskih maski.

Treniranjem druge mreže na transformiranim slikama pojednostavljuje se granica segmentacije, te se time mogu koristiti mreže s manje parametara za zadatak segmentacije. Mreže s manje parametara trebaju manje podataka za treniranje, tako da ovaj pristup prirodno dovodi do povećanja učinkovitosti podataka. Rezultati pokazuju usporedivu ili poboljšanu točnost korištenjem manjeg uzorka ili manjeg broja oznaka u različitim aplikacijama medicinskih slika, kao što su segmentacija jetre i epikardijalnog masnog tkiva iz CT skeniranja, kožnih lezija, polipa iz kolonoskopskih slika i stanica iz mikroskopskih slika.

Spomenute dvije mreže mogu biti zasebne neuronske mreže ili se mogu povezati i zajednički trenirati. Značajna je prednost ovog pristupa to što mreže za grubu lokalizaciju i finu segmentaciju mogu dijeliti istu često korištenu arhitekturu za segmentaciju medicinskih slika. To omogućuje jednostavan prijenos znanja između dviju mreža, ubrzavajući vrijeme obuke i poboljšavajući točnost. Osim toga, mreže se mogu unaprijed trenirati uz pomoć postojećih dostupnih skupova podataka ili neuronskih mreža za segmentaciju medicinskih slika.

U svrhu poboljšanja podatkovne učinkovitosti segmentacije medicinskih slika, ovaj doktorski rad predstavlja sljedeće izvorne znanstvene doprinose:

\begin{enumerate}
	\item \textbf{Nova metoda segmentacije biomedicinskih slika temeljena na pretprocesiranju polarnom transformacijom s naučenim ishodištem.} Predstavljena je nova tehnika pretprocesiranja medicinskih slika, posebice onih koje sadrže objekte eliptičnih oblika. Primjenom polarne transformacije kružne se granice odluke pojednostavljuju u linearne, što čini segmentaciju jednostavnijom. Razvijena je neuronska mreža da identifikaciju optimalnog ishodišta polarne transformacije. Poboljšana je kvaliteta segmentacije i omogućeno korištenje manje kompleksnih neuronskih mreža.
	\item \textbf{Poboljšanje metode za smanjenje veličine ulaznih slika u neuronske mreže obrezivanjem i korištenjem značajnih dijelova slike.} Motivirano uvidima korištenjem polarne transformacije, predložena je tehnika obrezivanja slika navođena modelom u svrhu smanjenja veličine ulaznih slika u neuronsku mrežu bez gubitka detalja. Precizna je segmentacija zadržana usprkos smanjenju veličine ulazne slike time što se ciljani objekt lokalizira u slici niske rezolucije te se obrezuje regija od interesa iz slike visoke rezolucije. Pokazano je da ovaj pristup povećava podatkovnu učinkovitost jer kompleksnost modela raste s veličinom ulazne slike.
	\item \textbf{Nova arhitektura neuronske mreže za segmentaciju slika visoke rezolucije koja kombinira detekciju objekata na slikama niske rezolucije i segmentaciju objekata na slikama visoke rezolucije.} Predstavljene metode pretprocesiranja slika su dodatno unaprijeđene tako što se razvila cjelovita neuronska mreža koja se može u cijelosti trenirati koja kombinira detekciju objekta na slici niske rezolucije i segmentira objekt na obrezanom dijelu slike visoke rezolucije. Mreži je omogućena konvergencija na dva načina. Prvo, koristi se ista arhitektura mreže za grubu i detaljnu segmentaciju, što omogućuje prijenosno učenje. Drugo, informacije se prosljeđuju od grube do detaljne segmentacijske podmreže, što osigurava tok gradijenta kroz cijelu mrežu. Pokazano je da treniranje ove cjelovite mreže povećava robusnost i grubog i detaljnog stadija segmentacije.
	\item \textbf{Nova metoda ugradnje dubinskih informacija u ulazne podatke dvodimenzionalne konvolucijske neuronske mreže.} S obzirom na ograničenja u podatkovnoj učinkovitosti 3D neuronskih mrežama za segmentaciju volumetričnih slika kao što je CT, razvijena je metoda ugradnje dubinskih informacija u 2D presjeke slike proširenjem presjeka dodatnim kanalom koji predstavlja normaliziranu z koordinatu. Pokazano je da ovo omogućuje uspješnu segmentaciju CT slika s 2D mrežama temeljenih na presjecima.
\end{enumerate}

Svaka se od predstavljenih metoda može koristiti kao opći korak pretprocesiranja neovisno o korištenoj arhitekturi konvolucijske neuronske mreže. Ovi doprinosi prikazuju mogućnosti općenitog pojednostavljenja zadataka segmentacije medicinskih slika i poboljšanja podatkovne učinkovitosti s raznim modalitetima i zadacima medicinskih slika.

Kao rezultat istraživanja predstavljenog u ovom doktorskom radu objavljeno je četiri rada u međunarodnim znanstvenim časopisima (svi kao prvi autor) i četiri rada na međunarodnim znanstvenim skupovima (od kojih tri kao prvi autor).